# docker/Dockerfile.worker.test
FROM python:3.11-slim

RUN apt-get update && apt-get install -y --no-install-recommends \
    build-essential curl ca-certificates && \
    rm -rf /var/lib/apt/lists/*

WORKDIR /opt/app

# Install your SDK (editable-like when we bind-mount repo in CI not needed)
COPY . /src
RUN pip install --no-cache-dir -U pip wheel && \
    pip install --no-cache-dir /src

# Test-time injector for pubkey fetch, etc.
COPY docker/inject/ /opt/inject/
ENV PYTHONPATH=/opt/inject
ENV PYTHONUNBUFFERED=1

CMD ["echo", "worker_ready"]
